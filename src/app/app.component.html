<div class="app-container">
  <!-- Left Sidebar -->
  <div class="sidebar">
    <div class="sidebar-header">
      <h1>Letter Composer</h1>
    </div>

    <div class="sidebar-content">
      <!-- Upload Section -->
      <div class="upload-section">
        <div class="upload-item" (click)="onTemplateClick()">
          <div class="upload-icon">üìÑ</div>
          <span>Template</span>
          <input type="file" #fileInputTemplate accept="image/*,.pdf" (change)="onTemplateChange($event)" style="display: none;">
        </div>

        <div class="upload-item" (click)="onSignatureClick()">
          <div class="upload-icon">‚úçÔ∏è</div>
          <span>Signature</span>
          <input type="file" #fileInputSignature accept="image/*,.pdf" (change)="onSignatureChange($event)" style="display: none;">
        </div>

        <div class="upload-item" (click)="onLetterBodyClick()">
          <div class="upload-icon">üìã</div>
          <span>Letter Body</span>
          <input type="file" #fileInputLetter accept="image/*,.pdf" (change)="onLetterBodyChange($event)" style="display: none;">
        </div>
        <div class="upload-item" (click)="toggleTextMode()">
  <div class="upload-icon">üìù</div>
  <span>Add Text</span>
</div>
      </div>

      <!-- Template Selector -->
<div class="settings-section">
  <h3>Letter Template</h3>
  <div class="template-selector">
    <select [(ngModel)]="selectedTemplate" class="template-dropdown">
      <option *ngFor="let template of templates" [value]="template.value">
        {{template.name}}
      </option>
    </select>
    <button class="apply-template-btn" (click)="applyTemplate()">
      Apply Template
    </button>
  </div>
</div>

      <!-- Background Removal -->
      <div class="settings-section">
        <h3>Background Removal</h3>
        
        <div class="setting-item">
          <label>Threshold <span class="value">{{threshold}}</span></label>
          <input type="range" [(ngModel)]="threshold" min="1" max="100" class="range-slider">
        </div>

        <div class="setting-item">
          <label>Smoothing <span class="value">{{smoothing}}</span></label>
          <input type="range" [(ngModel)]="smoothing" min="0" max="10" class="range-slider">
        </div>

        <div class="checkbox-item">
          <input type="checkbox" id="autoDetect" [(ngModel)]="autoDetect">
          <label for="autoDetect">Auto-detect</label>
        </div>
      </div>

      <!-- Export -->
      <div class="export-section">
        <button class="export-btn primary" (click)="exportAsPDF()">
          <span>üìÑ</span> Export PDF
        </button>
        <button class="export-btn secondary" (click)="exportAsImage()">
          <span>üñºÔ∏è</span> Export Image
        </button>
      </div>

      <!-- Status -->
      <div *ngIf="statusMessage" class="status-bar" [class.success]="statusType === 'success'" [class.error]="statusType === 'error'" [class.processing]="statusType === 'processing'">
        {{statusMessage}}
      </div>
    </div>
  </div>

  <!-- Text Toolbar (Photoshop style) -->
<div class="text-toolbar" *ngIf="isTextMode" [style.z-index]="1000">
    <div class="toolbar-item" [class.active]="fontWeight === 'bold'" (click)="toggleBold()" title="Bold">
      <strong>B</strong>
    </div>
    <div class="toolbar-item italic" [class.active]="fontStyle === 'italic'" (click)="toggleItalic()" title="Italic">
      <em>I</em>
    </div>
    <div class="toolbar-item" [class.active]="textDecoration === 'underline'" (click)="toggleUnderline()" title="Underline">
      <u>U</u>
    </div>
    
    <div class="toolbar-divider"></div>
    
<div class="toolbar-select">
  <div class="toolbar-label">Font:</div>
  <select [(ngModel)]="fontFamily" class="toolbar-dropdown">
    <option *ngFor="let font of fontFamilies" [value]="font">{{font}}</option>
  </select>
</div>

<div class="toolbar-select">
  <div class="toolbar-label">Size:</div>
  <select [(ngModel)]="fontSize" class="toolbar-dropdown size">
    <option *ngFor="let size of fontSizes" [value]="size">{{size}}px</option>
  </select>
</div>
    
    <div class="toolbar-divider"></div>
    
    <div class="toolbar-color">
      <input type="color" [(ngModel)]="textColor" class="color-picker">
    </div>
  </div>

  <!-- Canvas Area -->
  <div class="canvas-area">
    <!-- Top Toolbar -->
    <div class="top-toolbar">
      <div class="toolbar-left">
        <button class="tool-btn" [class.active]="isTextMode" (click)="toggleTextMode()" title="Text Tool">
          <span>T</span>
        </button>
      </div>
      
      <div class="toolbar-center">
        <span class="zoom-label">{{(zoom * 100).toFixed(0)}}%</span>
      </div>
      
      <div class="toolbar-right">
        <button class="zoom-btn" (click)="zoomOut()" title="Zoom Out">
          <span>‚àí</span>
        </button>
        <button class="zoom-btn" (click)="resetZoom()" title="Reset">
          <span>1:1</span>
        </button>
        <button class="zoom-btn" (click)="zoomIn()" title="Zoom In">
          <span>+</span>
        </button>
      </div>
    </div>

    <!-- Canvas Container -->
    <div class="canvas-wrapper" #canvasWrapper>
<canvas 
  #canvas
  tabindex="0"
  [class.text-cursor]="isTextMode"
  (mousedown)="onCanvasMouseDown($event)"
  (mousemove)="onCanvasMouseMove($event)"
  (mouseup)="onCanvasMouseUp()"
  (mouseleave)="onCanvasMouseUp()"
  (keydown)="onKeyDown($event)"
  (paste)="onPaste($event)">
</canvas>
    </div>
  </div>
</div>